<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">

</head>

<body>
    <div class="container" style="margin-top: 80px;">
        <div class="row">
            <div class="col-md-12">
                <div id="head" class="panel with-nav-tabs" style="width: 100%;">
                    <div class="panel-heading">
                        <ul class="nav nav-tabs">
                            <li class="active"><a href="#tab1info" data-toggle="tab">Step 1</a></li>
                            <li><a href="#tab2info" data-toggle="tab">Step 2</a></li>
                            <li><a href="#tab3info" data-toggle="tab">Step 3</a></li>
                            <li><a href="#tab4info" data-toggle="tab">Result</a></li>

                        </ul>
                    </div>
                    <div class="panel-body">
                        <div class="tab-content">
                            <div class="tab-pane fade in active" id="tab1info">
                                <h3>Clock pulse</h3>

                                <label>From:(secend)</label>
                                <input id="x" name="x" value="0" type="text" style="width: 10%; margin-right: 100px;" readonly>
                                <img src="img/heartbeat.png" width="10%">
                                <label style="margin-left: 100px;">To:(secend)</label>
                                <input id="y" type="number" style="width: 10%; margin-right: 100px;">
                                <button id="add" type="" class="btn btn-submit">Add</button>

                                <button id="sub" class="btn btn-submit">Submit</button>
                                </br>
                                <h4 id="insert"></h4>
                                <div id="chartContainer" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: none">
                                </div>

                            </div>
                            <div class="tab-pane fade in" id="tab2info">
                                <h3>J Pin</h3>
                                <label>From:(secend)</label>
                                <input id="x_jPin" name="x" value="0" readonly type="text" style="width: 10%; margin-right: 100px;">
                                <img src="img/heartbeat.png" width="10%">
                                <label style="margin-left: 100px;">To:(secend)</label>
                                <input id="y_jPin" type="number" style="width: 10%; margin-right: 100px;">
                                <button id="add_jPin" type="submit" class="btn btn-submit">Add</button>
                                <button id="sub_jPin" class="btn btn-submit">Submit</button>
                                </br>
                                <h4 id="insert2"></h4>
                                <div id="chartContainer1" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: none">
                                </div>
                            </div>
                            <div class="tab-pane fade in" id="tab3info">
                                <h3>K Pin</h3>
                                <label>From:(secend)</label>
                                <input id="x_kPin" name="x" value="0" readonly type="text" style="width: 10%; margin-right: 100px;">
                                <img src="img/heartbeat.png" width="10%">
                                <label style="margin-left: 100px;">To:(secend)</label>
                                <input id="y_kPin" type="number" style="width: 10%; margin-right: 100px;">
                                <button id="add_kPin" type="submit" class="btn btn-submit">Add</button>
                                <button id="sub_kPin" class="btn btn-submit">Submit</button>
                                </br>
                                <h4 id="insert3"></h4>
                                <div id="chartContainer2" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: none">
                                </div>

                            </div>
                            <div class="tab-pane fade in" id="tab4info">

                                <button class="btn btn-success btn-lg btn-block" type="submit" id="submit">Submit</button>
                                <div id="result" style="display: none;">
                                    <div id="chart" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: none"></div>
                                    <div id="chart1" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: none"></div>
                                    <div id="chart2" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: none"></div>
                                    <div id="chartContainer3" style="height: 300px; width: 100%;margin-bottom: 30px;border: solid 2px black;display: block"></div>


                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>

    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script>
    </script>
    <script>
        var input1 = document.getElementById("y");
        input1.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("add").click();
            }
        });

        var input1 = document.getElementById("y_jPin");
        input1.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("add_jPin").click();
            }
        });

        var input1 = document.getElementById("y_kPin");
        input1.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("add_kPin").click();
            }
        });
    </script>
    <script>
        class Node {
            constructor(x, y) {
                this.x = x;
                this.y = y;
            }
        }

        window.onload = function() {
            var xList = [];
            var yList = [];
            var x_jPin = [];
            var y_jPin = [];
            var x_kPin = [];
            var y_kPin = [];
            var x_f = [];
            var y_f = [];
            var index1 = 0;
            var index2 = 0;
            var index3 = 0;

            document.getElementById("add").addEventListener("click", function() {
                xList.push(index1);
                yList.push($("#y").val());
                $('#insert').append("[" + index1++ + " : " + $("#y").val() + "]" + "  ");
                console.log(xList, yList);
                $("#y").val("");
                $("#x").val(index1);
            });
            document.getElementById("add_jPin").addEventListener("click", function() {
                x_jPin.push(index2);
                y_jPin.push($("#y_jPin").val());
                $('#insert2').append("[" + index2++ + " : " + $("#y_jPin").val() + "]" + "  ");
                $("#y_jPin").val("");
                $("#x_jPin").val(index2);
            });

            document.getElementById("add_kPin").addEventListener("click", function() {
                x_kPin.push(index3);
                y_kPin.push($("#y_kPin").val());
                $('#insert3').append("[" + index3++ + " : " + $("#y_kPin").val() + "]" + "  ");
                $("#y_kPin").val("");
                $("#x_kPin").val(index3);
            });

            $('#sub').click(function() {
                var node_clk = [];
                $("#chartContainer").css("display", "block");
                for (var index = 0; index < xList.length; index++) {
                    node_clk.push(new Node(parseInt(xList[index], 10), parseInt(yList[index], 10)));
                }
                var chart = new CanvasJS.Chart("chartContainer", {
                    animationEnabled: true,
                    exportEnabled: true,
                    title: {
                        text: "Clock Pulse"
                    },
                    axisY: {
                        title: "Voltage",
                        includeZero: false,
                        interval: 5,
                        suffix: "v",
                        valueFormatString: "#0"
                    },
                    axisX: {
                        title: "Time",
                        includeZero: false,
                        interval: 1,
                        suffix: "s",
                        valueFormatString: "#0"
                    },
                    data: [{

                        type: "stepLine",
                        yValueFormatString: "#0",
                        xValueFormatString: "#0",
                        markerSize: 5,
                        dataPoints: node_clk

                    }]
                });

                chart.render();
                console.log("clk");
                console.log(xList, yList);
            })

            $('#sub_jPin').click(function() {
                var node_jPin = [];
                $("#chartContainer1").css("display", "block");
                for (var index = 0; index < xList.length; index++) {
                    node_jPin.push(new Node(parseInt(x_jPin[index], 10), parseInt(y_jPin[index], 10)));
                }
                var chart1 = new CanvasJS.Chart("chartContainer1", {
                    animationEnabled: true,
                    exportEnabled: true,
                    title: {
                        text: "J pin"
                    },
                    axisY: {
                        title: "Voltage",
                        includeZero: false,
                        interval: 5,
                        suffix: "v",
                        valueFormatString: "#0"
                    },
                    axisX: {
                        title: "Time",
                        includeZero: false,
                        interval: 1,
                        suffix: "s",
                        valueFormatString: "#0"
                    },
                    data: [{

                        type: "stepLine",
                        yValueFormatString: "#0",
                        xValueFormatString: "#0",
                        markerSize: 5,
                        dataPoints: node_jPin
                    }]
                });
                chart1.render();
                console.log("j");
                console.log(x_jPin, y_jPin);

            });
            $('#sub_kPin').click(function() {
                var node_kPin = [];
                $("#chartContainer2").css("display", "block");

                for (var index = 0; index < xList.length; index++) {
                    node_kPin.push(new Node(parseInt(x_kPin[index], 10), parseInt(y_kPin[index], 10)));
                }
                var chart2 = new CanvasJS.Chart("chartContainer2", {
                    animationEnabled: true,
                    exportEnabled: true,
                    title: {
                        text: "Set Pin"
                    },
                    axisY: {
                        title: "Voltage",
                        includeZero: false,
                        interval: 5,
                        suffix: "v",
                        valueFormatString: "#0"
                    },
                    axisX: {
                        title: "Time",
                        includeZero: false,
                        interval: 1,
                        suffix: "s",
                        valueFormatString: "#0"
                    },
                    data: [{

                        type: "stepLine",
                        yValueFormatString: "#0",
                        xValueFormatString: "#0",
                        markerSize: 5,
                        dataPoints: node_kPin
                    }]
                });
                chart2.render();
                console.log("k", x_kPin, y_kPin);
            });
            $("#submit").click(function() {
                $("#result").css("display", "block");
                for (var index = 0; index < xList.length; index++) {
                    if (index != 0 && yList[index] == 5 && yList[index - 1] == 0) {
                        // Set
                        if (y_jPin[index] > y_kPin[index]) {
                            console.log("SET", index)
                            x_f.push(index);
                            y_f.push(5);
                        }
                        // ReSet
                        else if (y_jPin[index] < y_kPin[index]) {
                            console.log("PRESET", index)
                            x_f.push(index);
                            y_f.push(0);
                        }
                        // Latch
                        else if (y_jPin[index] == 0 && y_kPin[index] == 0) {
                            console.log("LATCH", index)
                            if (index != 0) {
                                y_f.push(y_f[index - 1]);
                                x_f.push(index);
                            } else {
                                y_f.push(0);
                                x_f.push(index);
                            }
                        }
                        // Toggle
                        else if (y_jPin[index] == 1 && y_kPin[index] == 1) {
                            console.log("TOGGLE", index)
                            if (y_f[index - 1] == 5) {
                                y_f.push(0);
                            } else {
                                y_f.push(5);
                            }
                            x_f.push(index);
                        }
                    } else {
                        y_f.push(0);
                        x_f.push(index)
                    }


                }
                var node_fPin = [];

                for (var index = 0; index < xList.length; index++) {
                    node_fPin.push(new Node(parseInt(x_f[index], 10), parseInt(y_f[index], 10)));
                }
                var chart3 = new CanvasJS.Chart("chartContainer3", {
                    animationEnabled: true,
                    exportEnabled: true,
                    title: {
                        text: "Reset pin"
                    },
                    axisY: {
                        title: "Voltage",
                        includeZero: false,
                        interval: 5,
                        suffix: "v",
                        valueFormatString: "#0"
                    },
                    axisX: {
                        title: "Time",
                        includeZero: false,
                        interval: 1,
                        suffix: "s",
                        valueFormatString: "#0"
                    },
                    data: [{

                        type: "stepLine",
                        yValueFormatString: "#0",
                        xValueFormatString: "#0",
                        markerSize: 5,
                        dataPoints: node_fPin
                    }]
                });
                chart3.render();
                console.log("result", x_f, y_f);
                var chartt = document.getElementById("chart");
                var chartt1 = document.getElementById("chart1");
                var chartt2 = document.getElementById("chart2");
                var chartContainer = document.getElementById("chartContainer");
                var chartContainer1 = document.getElementById("chartContainer1");
                var chartContainer2 = document.getElementById("chartContainer2");
                chartt.innerHTML = chartContainer.innerHTML;
                chartt1.innerHTML = chartContainer1.innerHTML;
                chartt2.innerHTML = chartContainer2.innerHTML;
            });

        }
    </script>

</body>

</html>
